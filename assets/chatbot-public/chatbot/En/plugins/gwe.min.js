/*!
 * widgets
 * @version: 9.0.017.00
 * @license: Genesys Telecom Labs
 */
widgetsJsonpFunction([25],{"./webapp/plugins/cx-gwe/cx-gwe.js":function(e,n,t){"use strict";var o,a,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o=[t("./node_modules/jquery/dist/jquery.js"),t("./webapp/plugins/cx-common/cx-common.js")],void 0!==(a=function(e,n){function t(){if(!S)return!1;for(var e in x)if(x[e].opened)return!0;return!1}function o(n){if(t())_gt.push(["event","Disposition",{data:{actionID:n.actionID,engagementID:n.engagementID,media:n.media,result:"error",code:"mediaBusy"}}]);else{b=n;var o=n.container||{};o==={}&&n.content&&(o.type="custom"),o.body=n.content,m.command("Toaster.open",o).done((function(t){t.html&&(s(),(v=e(t.html)).find(".cx-btn.cx-btn-primary").on("click",(function(){v.data("timeout",""),r(n.dispositions.accept.code,n.media,n.engagementID,n.actionID),c().done((function(){n.dispositions.accept.command&&m.command(n.dispositions.accept.command,n.dispositions.accept.data)}))})),v.find(".cx-btn.cx-btn-default").on("click",(function(){v.data("timeout",""),r(n.dispositions.cancel.code,n.media,n.engagementID,n.actionID),c(),n.dispositions.cancel.command&&m.command(n.dispositions.cancel.command,n.dispositions.cancel.data)})),v.find(".cx-button-close").on("click",(function(){v.data("timeout",""),r(n.dispositions.cancel.code,n.media,n.engagementID,n.actionID),n.dispositions.cancel.command&&m.command(n.dispositions.cancel.command,n.dispositions.cancel.data)})),m.command("Watchman.countdown",{time:parseInt(n.timeout/1e3)||30}).done((function(e){v.data("timeout",e),n.dispositions.timeout.code&&m.subscribe(e,(function(){h&&v.data("timeout")==e&&(y.countdownEvent&&m.unsubscribe(y.countdownEvent),r(n.dispositions.timeout.code,n.media,n.engagementID,n.actionID),c().done((function(){n.dispositions.timeout.command&&m.command(n.dispositions.timeout.command,n.dispositions.timeout.data)})))}))})),h=!0)})).fail((function(e){}))}}function a(n){if(t())_gt.push(["event","Disposition",{data:{actionID:n.actionID,engagementID:n.engagementID,media:n.type,result:"error",code:"mediaBusy"}}]);else{var o={type:"generic",title:n.subject||"Need help?",body:n.message||"Let us know if we can help out.",icon:"chat",controls:"close",buttons:{type:"binary",primary:n.acceptBtnCaption||"Start chat",secondary:n.cancelBtnCaption||"No thanks"}};m.command("Toaster.open",o).done((function(t){t.html&&(d(),(f=e(t.html)).find(".cx-btn.cx-btn-primary").on("click",(function(){y.countdownEvent&&m.unsubscribe(y.countdownEvent),m.command("Toaster.close").done((function(){u(D.ACCEPT);var e={},t=n.chatOptions||{};!1===t.registration&&"object"==i(t.userData)&&(e.autoSubmit=!0,e.firstname=t.userData.firstName,e.lastname=t.userData.lastName,e.email=t.userData.email),_gt.push(["getIDs",function(n){g=n,m.command("WebChat.open",{attachedData:{visitID:n.visitID,pageID:n.pageID,webengagement:""},form:e,userData:t.userData||{}})}]),d()}))})),f.find(".cx-btn.cx-btn-default").on("click",(function(){y.countdownEvent&&m.unsubscribe(y.countdownEvent),d(),u(D.CANCEL)})),f.find(".cx-button-close").on("click",(function(){y.countdownEvent&&m.unsubscribe(y.countdownEvent),d(),u(D.CANCEL)})),m.command("Watchman.countdown",{time:parseInt(n.inviteTimeout)||30}).done((function(e){y.countdownEvent=e,m.subscribe(e,(function(){u(D.TIMEOUT),f&&f&&m.command("Toaster.close").done((function(){d()}))}))}))),C=!0})).fail((function(e){}))}}function c(){if(v)return m.command("Toaster.close").done((function(){s()}))}function d(){f&&(f.remove(),f=!1)}function s(){v&&(v.remove(),v=!1,b=!1)}function r(e,n,t,o){g?_gt.push(["event","Disposition",{data:{actionID:o,engagementID:t,result:e,media:n}}]):_gt.push(["getIDs",function(a){g=a,_gt.push(["event","Disposition",{data:{actionID:o,engagementID:t,result:e,media:n}}])}]),h=!1}function u(n,t){_gt.push(["getIDs",function(t){g=t,e.ajax({type:"GET",crossDomain:!0,url:(p.httpEndpoint||p.httpsEndpoint)+"/server/data/invites",xhrFields:{withCredentials:!0},data:{result:n,media:"chat",visitID:t.visitID,pageID:t.pageID,alias:t.alias,engagementID:I,webengagement:""}}).done((function(e){}))}]),C=!1}function l(){C&&u(D.PAGE_EXIT),h&&(r(b.dispositions.pageExit.code,b.media,b.engagementID,b.actionID),b.dispositions.pageExit.command&&m.command(b.dispositions.pageExit.command,b.dispositions.pageExit.data))}window._gt=window._gt||[];var m=CXBus.registerPlugin("GWE"),p={},g=!1,f=!1,v=!1,b=!1,h=!1,C=!1,D={ACCEPT:"accept",TIMEOUT:"timeout",PAGE_EXIT:"pageExit",CANCEL:"cancel"},w={"WebChatService.error":!0,"WebChatService.clientConnected":!0,"WebChatService.agentConnected":!0,"WebChatService.started":!0,"WebChatService.ended":!0,"WebChatService.disconnected":!0,"WebChat.opened":!0,"WebChat.started":!0,"WebChat.cancelled":!0,"WebChat.completed":!0,"WebChat.closed":!0,"SendMessageService.error":!0,"SendMessage.opened":!0,"SendMessage.started":!0,"SendMessage.cancelled":!0,"SendMessage.completed":!0,"SendMessage.closed":!0,"CallbackService.scheduled":!0,"CallbackService.scheduleError":!0,"CallbackService.availabilityError":!0,"Callback.opened":!0,"Callback.started":!0,"Callback.cancelled":!0,"Callback.completed":!0,"Callback.closed":!0,"CallUs.opened":!0,"CallUs.closed":!0,"ChannelSelector.opened":!0,"ChannelSelector.closed":!0,"CoBrowse.started":!0,"CoBrowse.stopped":!0,"KnowledgeCenterService.sessionChanged":!0,"KnowledgeCenterService.noResultsFound":!0,"KnowledgeCenterService.documentOpened":!0,"KnowledgeCenterService.searched":!0,"KnowledgeCenterService.voted":!0,"Search.opened":!0,"Search.closed":!0,"ChatDeflection.started":!0,"ChatDeflection.ended":!0},E=function(e){var n=e.event,t={data:{}};t.data[n]=e.data|{},_gt.push(["event",n,t])},I="",y={countdownEvent:null},S=!0,x={WebChat:{opened:!1},SendMessage:{opened:!1},Callback:{opened:!1},CallUs:{opened:!1}};if(m){for(var _ in x)m.subscribe(_+".opened",(function(){x[_].opened=!0})),m.subscribe(_+".closed",(function(){x[_].opened=!1}));m.registerEvents(["ready"]),m.registerCommand("getIDs",(function(e){g?e.deferred.resolve(g):_gt.push(["getIDs",function(n){g=n,e.deferred.resolve(g)}])})),m.registerCommand("sendDisposition",(function(e){if(_gt){var n={};for(var t in e.data)n[t]=e.data[t];_gt.push(["event","Disposition",{data:n}]),e.deferred.resolve()}else e.deferred.reject("GWE is not available")})),m.registerCommand("push",(function(e){if(_gt){var n=e.data;"object"==(void 0===n?"undefined":i(n))&&"function"==typeof n.shift&&"number"==typeof n.length&&n.length>0?(_gt.push(n),e.deferred.resolve()):e.deferred.reject("Attempted to push invalid data. Expected an array of values.")}else e.deferred.reject("GWE is not available")})),m.registerCommand("invite",(function(e){o(e.data)})),m.registerCommand("configure",(function(n){if("GWE"==n.commander||"App"==n.commander)if(n.data){if(n.data.httpEndpoint||n.data.httpsEndpoint){for(var t in p=n.data,_gt.push(["config",p]),_gt.push(["getIDs",function(e){g=e}]),_gt.push(["on","notificationMessage",function(e){return"gpe.setVariable"===e.channel&&"chat"===e.data.value.type?(I=e.data.value.engagementID,a(e.data.value),!1):"gpe.setVariable"===e.channel&&"offers"===e.data.value.type?(I=e.data.value.engagementID,function(e){m.command("Offers.configure",e).done((function(){m.command("Offers.open").done((function(){}))}))}(e.data.value),!1):("gpe.setVariable"===e.channel&&"sendmessage"===e.data.value.type&&(I=e.data.value.engagementID,e.data.value,m.command("SendMessage.open").done((function(){}))),"gpe.appendContent"!==e.channel&&("CXBus"===e.channel?(m.command("Remote.execute",e.data||{}),!1):void 0))}]),"object"==i(n.data.trackedEvents)&&(w=e.extend(w,n.data.trackedEvents)),!1===n.data.smartInvites&&(S=!1),w)!0===w[t]&&m.subscribe(t,E);!function(){if(!document.getElementById("_gt")){var e=document.createElement("script");e.id="_gt",e.src=(p.httpEndpoint||p.httpsEndpoint)+"/server/resources/js/build/GTCJ.min.js",(document.getElementsByTagName("head")[0]||document.body).appendChild(e)}}(),window.addEventListener&&e(window).on("beforeunload",l),window.attachEvent&&(window.attachEvent("onbeforeunload",l),window.attachEvent("onunload",l))}n.deferred.resolve()}else n.deferred.reject("Invalid configuration");else n.deferred.reject("Forbidden: Access Denied")})),m.command("configure",n.checkPath(window,"_genesys.cxwidget.gwe")||n.checkPath(window,"_genesys.widgets.gwe")||{}),m.subscribe("App.closeAll",(function(e){})),m.ready(),m.republish("ready")}}.apply(n,o))&&(e.exports=a)}},["./webapp/plugins/cx-gwe/cx-gwe.js"]);