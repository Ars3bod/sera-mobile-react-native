/*!
 * widgets
 * @version: 9.0.017.00
 * @license: Genesys Telecom Labs
 */
widgetsJsonpFunction([23],{"./webapp/plugins/cx-send-message-service/cx-send-message-service.js":function(e,a,t){"use strict";var s,r,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};s=[t("./node_modules/jquery/dist/jquery.js"),t("./webapp/plugins/cx-common/cx-common.js")],void 0!==(r=function(e,a){var t=CXBus.registerPlugin("SendMessageService");if(t){var s={dataURL:"",iApiKey:"",iAjaxTimeout:3e3,uploadsEnabled:!0},r={},o=function(e,a,s,r){400==e.status?e.responseText=JSON.parse(e.responseText):500==e.status&&(e.statusCode=202),t.publish("error",{result:e.responseText,textStatus:a,statusCode:e.status}),r.reject()},i=function(e,a,r,n){var o=s.uploadsEnabled?JSON.parse(e):e;o.interactionId?(t.publish("messageSent",{interactionId:o.interactionId}),n.resolve()):(e=JSON.parse(e),t.publish("error",{result:e,textStatus:a,jqXHR:r}),n.reject())},d=function(e){s.iApiKey&&e.setRequestHeader("apikey",s.iApiKey),s.ccid&&e.setRequestHeader("ContactCenterId",s.ccid)};t.registerEvents(["ready","messageSent","error"]),t.registerCommand("sendForm",(function(a){if(a.data){var t=a.data.formData,n=e.extend({},r,a.data.userData||{});if(s.uploadsEnabled)if(window.FormData){var u=new FormData;for(var p in u.append("lastName",t.lastname||t.lastName||""),u.append("firstName",t.firstname||t.firstName||""),u.append("fromAddress",t.email||""),u.append("subject",t.subject||""),u.append("text",t.text||t.messagebody||""),n)u.append("userData",p+"="+n[p]);a.data.files&&e.each(a.data.files,(function(e,a){u.append("files",a)})),e.ajax({type:"POST",url:s.dataURL,mimeType:"multipart/form-data",contentType:!1,crossDomain:!0,processData:!1,data:u,beforeSend:d,success:function(e,t,s){i(e,t,s,a.deferred)},error:function(e,t,s){o(e,t,0,a.deferred)}})}else a.deferred.reject("No HTMl5 formData support on your browser");else{var c,m=[],f={firstName:t.firstName||t.lastname||"",lastName:t.lastName||t.lastname||"",fromAddress:t.email||"",subject:t.subject||"",text:t.text||t.messagebody||""};for(var p in f)m.push(encodeURIComponent(p)+"="+encodeURIComponent(f[p]));for(var p in n)m.push("userData="+encodeURIComponent(p+"="+n[p]));c=m.join("&").replace(/%20/g,"+"),e.ajax({type:"POST",url:s.dataURL,crossDomain:!0,timeout:s.iAjaxTimeout,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:c,beforeSend:d,success:function(e,t,s){i(e,t,s,a.deferred)},error:function(e,t,s){o(e,t,0,a.deferred)}})}}else a.deferred.reject("No formData found")})),t.subscribe("GWE.ready",(function(){t.command("GWE.getIDs").done((function(a){e.extend(r,a)}))})),t.registerCommand("configure",(function(a){if(a.data){var t=a.data;"string"==typeof t.dataURL&&(s.dataURL=t.dataURL),"string"!=typeof t.apikey&&"number"!=typeof t.apikey||(s.iApiKey=t.apikey),"number"==typeof t.ajaxTimeout&&(s.iAjaxTimeout=parseInt(t.ajaxTimeout)),"boolean"==typeof t.uploadsEnabled&&(s.uploadsEnabled=t.uploadsEnabled),"object"==n(t.userData)&&e.extend(r,t.userData),t.ccid&&(s.ccid=t.ccid),a.deferred.resolve()}else a.deferred.reject("Invalid configuration")})),t.command("configure",_genesys.widgets.sendmessage),t.ready(),t.republish("ready")}}.apply(a,s))&&(e.exports=r)}},["./webapp/plugins/cx-send-message-service/cx-send-message-service.js"]);